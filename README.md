# foodcloud

두 번째 포트폴리오는 위에서 경험한 것들을 토대로 엔티티(Entity) 설계에 조금 더 신경을 썼습니다.
그래도 경험의 부족으로 작업을 하면서 조금씩 수정이 되는 것은 어쩔 수가 없었습니다. 이것은 경험이 부족하였기 때문이라고 생각했습니다.

**[[아쉬운 점]]**

예를 들면 OrderJoinGroup과 OrderMenu가 있는데, 두 곳 모든 사용자의 결제 수단에 대한 정보를 가지고 있을 필요가 없었습니다. OrderJoinGroup의 아래에 OrderMenu가 ManyToOne으로 들어가기 때문에 OrderMenu에만 있으면 되는 정보들을 OrderMain이 가지고 있고, OrderJoinGroup만 있으면 되는 정보들이 OrderMenu에도 들어가 있는 경우가 생겼습니다. 그래서 이 부분 때문에 많은 부분을 수정해야 하는 일이 있었습니다.

정규화를 하지 않고 작업을 한 것이 나중에 너무 크게 문제가 되었습니다. 이러한 부분 때문에 정규화를 하고 다시 모든 코드를 수정해야 하는 일이 발생되었습니다. 이를 통해서 데이터베이스 정규화의 중요성에 대해서 배울 수 있었습니다.

**[[잘한 점]]**

마지막으로 커스텀 익셉션을 사용하여 사용자에게 메세지 처리하고, 한글 사용자뿐 아니라 다른 나라의 사용자를 위한 출력을 위해 KoreanErrorEnum을 따로 만들어 관리했습니다. 이것을 통해서 레이어드 아키텍쳐를 지키고, **`OCP`** 원칙을 지키는 데에 더 큰 도움이 되겠다고 생각했습니다. 해외 사이트로 변하면 Enum만 바꾸어주면 다른 부분은 수정할 필요 없이 출력되는 언어가 바뀔 수 있도록 작업을 했습니다.

**`Optinal`** 을 적극적으로 활용했습니다. **`Null`** 처리에 조금 더 안전하게 코딩을 했다고 생각을 합니다. **`Optinal`** 을 사용하면서 람다식에 대해서도 공부할 수 있었습니다. 람다식을 사용하여 코드를 조금 더 가독성 좋게 작성할 수 있었습니다.

**[[다형성]]**

다형성은 **`Java`** 의 매우 중요한 부분이라고 생각합니다. 다형성을 제대로 이용할 수 있어야만 **`OCP원칙`** 을 지키면서 코드를 작성할 수 있습니다. 저는 결제 서비스의 API를 가상으로 만들면서 다형성에 대해 다시 공부하고, 적용할 수 있었습니다.
처음에는 **`다형성`** 을 제대로 구현하지 못하고, 제네릭을 사용하여 만들려고 하였으나, 이후 추상 클래스를 통하여 다형성을 완벽하게 갖출 수 있었습니다.

[이놈의 OCP!!!!!!!!! (상속과 JPA)](https://www.notion.so/OCP-JPA-5f319b47ceae4167bf4bb975cf56401e) 

**[[동시성]]**

주문이 동시에 들어오는 경우에 대해서 동시성의 체크가 필요했습니다. 음식 주문 카운트를 업데이트 해주어야 하는데, 이 부분에서 고민을 많이 했고, 많은 해결 방법 중에서 어떠한 방식으로 할까를 고민을 하다가 LockModeType.PESSIMISTIC_WRITE를 사용하기로 했습니다.

[DB Lock (feat.동시성?)](https://www.notion.so/DB-Lock-feat-63fc7961306f41769108db91474f7593)

**[[N+1 이슈]]**

JPA를 쓰면서 1:N은 최대한 피하려고 노력했습니다. 이유는 1:N의 경우에는 N+1의 이슈가 발생할 가능성이 높았기 때문입니다. 하지만 N:1을 쓴다고 해도 N+1의 이슈는 발생했고, LAZY모드의 경우에 HTML에서 사용해야 하는 경우에 오류가 발생하는 것을 알게 되었습니다.
이럴 해결하기 위해서 많은 방법을 고안했고, Fetch Join을 사용하기로 했습니다.

[JPA의 N + 1???? (OneToOne과 ManyToOne)](https://www.notion.so/JPA-N-1-OneToOne-ManyToOne-4b2f0f72bb8e40e3a89e8459e21ecbc1)

아쉬운 부분이 없지는 않습니다. 엔티티 설계에 조금 더신경을 써서 해야 했다고 생각했고, 처음에 설계를 잘못해서 뒤엎은 적도 있습니다. 하지만 이러한 경험들이 모이면 결국에는 제 실력이 될 수 있다고 생각합니다.
